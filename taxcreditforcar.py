# -*- coding: utf-8 -*-
"""
업종/차량 공제여부 조회 – Streamlit 앱

사용법
1) 이 파일을 예: app.py 로 저장
2) 터미널에서: streamlit run app.py
3) 브라우저에서 단계별로 선택 후 결과 확인

데이터는 '업종분석.xlsx', '차량분석.xlsx' 내용을 코드에 내장하여
외부 파일 없이 실행됩니다.
"""

import streamlit as st

# ===== 내장 데이터 =====
INDUSTRY_CLASS = {'건축업': 1,
 '농,임 어업': 1,
 '도소매': 1,
 '부동산임대업': 1,
 '서비스업': 1,
 '운수업': 1,
 '운수업(택시,자동차임대)': 2,
 '음식점': 1,
 '제조업': 1}

VEHICLES = {'GM대우': {'넥시아': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '라보': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
           '레이서': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '레간자': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '마티즈Ⅰ(2인승)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
           '마티즈Ⅱ(2인승)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
           '마티즈Ⅲ(2인승)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
           '브로엄': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '스파크(2인승)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
           '씨에로': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '아카디아': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '에스페로': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '우라칸': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
           '윈스톰': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '카마로': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '칼로스': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '캐딜락': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
           '콜로라도(적재함 있는 화물)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
           '토스카': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'}},
 '기아': {'K3': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        'K5': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        'K7': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        'K8': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        'K9': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '니로EV(적재함 있는 화물)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '레이(적재함 있는 화물)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '레이(적재함 없는 승용)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '로체': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '모닝(2인승)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '모닝(4인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '봉고Ⅲ(초장축/장축/표준캡)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '세피아': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '스팅어': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '스포티지(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '스포티지(5인~7인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '스포티지(7인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '스포티지(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '스포티지R(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '스포티지R(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '쏘렌토(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '쏘렌토(7인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '쏘렌토(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '쎄라토': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '엑센트': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '쏘울(2인승)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '쏘울(4인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '포르테': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'}},
 '기타': {'경운기': {'공제여부': '공제가능합니다.', '설명': '농업용 작업차'},
        '지게차': {'공제여부': '공제가능합니다.', '설명': '지게차(지게차 면허 필요)'}},
 '삼성': {'QM3(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        'QM3(적재함 있는 화물)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        'QM5(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        'QM5(7인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        'SM3': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        'SM5': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        'SM7': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'}},
 '쌍용': {'뉴체어맨': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '렉스턴(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '렉스턴(7인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '렉스턴(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '무쏘(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '무쏘(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '액티언(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '액티언(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '이스타나(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '체어맨': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'}},
 '현대': {'갤로퍼': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '그레이스(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '그레이스밴(적재함 있는 화물)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '베라크루즈': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '봉고(그레이스)(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '산타모(5인~7인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '산타모(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '산타페': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '스타렉스(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '스타렉스(적재함 있는 화물)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '스타리아(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '스타리아(9인승)': {'공제여부': '공제가능합니다.', '설명': '8인초과 승합'},
        '싼타페(5인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '싼타페(7인승)': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '아반떼': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '에쿠스': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '포니픽업': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '포터Ⅱ(초장축/장축/표준캡)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '포터Ⅱ(특장차,탑)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '포터Ⅱ(탑차)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'},
        '프라이드': {'공제여부': '공제되지 않습니다.', '설명': '개별소비세 대상차량'},
        '헤비듀티 트럭(적재함 있는 화물)': {'공제여부': '공제가능합니다.', '설명': '적재용 화물차'}}}

# ===== UI =====
st.set_page_config(page_title="업종·차량 공제여부 조회", page_icon="🚗")
st.title("업종·차량 공제여부 조회")
st.caption("업종을 먼저 선택한 뒤 지침에 따라 진행하세요.")

# 업종 선택
industries = sorted(INDUSTRY_CLASS.keys())
sel_industry = st.selectbox("업종 선택", options=["— 업종을 선택하세요 —"] + industries, index=0)

if sel_industry and sel_industry in INDUSTRY_CLASS:
    cls = INDUSTRY_CLASS[sel_industry]
    st.info(f"선택한 업종: **{sel_industry}** / 분류: **{cls}번**")

    if cls == 2:
        st.success("분류 2번이므로 해당 업종에 직접 사용하므로 공제가능합니다.")
        st.stop()

    # 분류 1번인 경우 회사 → 차종
    companies = sorted(VEHICLES.keys())
    sel_company = st.selectbox("회사명 선택", options=["— 회사를 선택하세요 —"] + companies, index=0)

    if sel_company and sel_company in VEHICLES:
        models = sorted(VEHICLES[sel_company].keys())
        sel_model = st.selectbox("차종 선택", options=["— 차종을 선택하세요 —"] + models, index=0)

        if sel_model and sel_model in VEHICLES[sel_company]:
            result = VEHICLES[sel_company][sel_model]

            st.markdown("---")
            st.subheader("결과")
            col1, col2 = st.columns(2)
            with col1:
                st.write(f"**회사명**: {sel_company}")
                st.write(f"**차종**: {sel_model}")
            with col2:
                st.write(f"**공제여부**: {result.get('공제여부', '정보 없음')}")
                st.write(f"**설명**: {result.get('설명', '정보 없음')}")

            if result.get('공제여부') == '공제가능합니다.':
                st.success("공제 가능 차량으로 분류됩니다.")
            else:
                st.error("공제 불가 차량으로 분류됩니다.")
else:
    st.warning("왼쪽에서 먼저 업종을 선택하세요.")
